<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sexual Assault Awareness</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for smoother transitions (Tailwind handles most) */
        .transition-all {
            transition-property: all;
            transition-duration: 300ms;
            transition-timing-function: ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100 text-gray-900 flex flex-col">

    <!-- Header -->
    <header class="bg-gray-800 text-white shadow-lg p-4 transition-all">
        <div class="container mx-auto flex flex-col sm:flex-row justify-between items-center">
            <!-- SAA Logo added here -->
            <img src="uploaded:image_5d0aa1.png-95f45799-3209-43af-bec1-a4640ac9821e" alt="SAA Logo" class="h-10 sm:h-auto max-h-12 w-auto mb-2 sm:mb-0 object-contain" style="max-width: 250px;">
            <div id="user-id-display" class="text-sm bg-gray-700 px-3 py-1 rounded-full opacity-80 hidden">
                User ID: <span id="current-user-id"></span>
            </div>
        </div>
        <!-- Navigation -->
        <nav class="container mx-auto mt-4">
            <ul class="flex flex-wrap justify-center sm:justify-start gap-2" id="main-nav">
                <!-- Nav items will be generated by JS -->
            </ul>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main class="container mx-auto flex-grow p-6 sm:p-8">
        <div id="content-area" class="bg-white rounded-xl shadow-lg p-6 sm:p-8 transition-all">
            <!-- Content will be injected here by JS -->
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-6 mt-8 transition-all">
        <div class="container mx-auto text-center text-sm">
            &copy; <span id="current-year"></span> Sexual Assault Awareness. All rights reserved.
            <p class="mt-2 text-gray-500">
                This app provides general information and resources. If you are in immediate danger, please call 911 or your local emergency services.
            </p>
        </div>
    </footer>

    <script type="module">
        // Firebase imports - these will be dynamically loaded if needed
        let firebaseApp, firebaseAuth, firestoreDb;
        let userId = null;
        let authReady = false;

        // Firebase configuration and app ID are provided by the environment
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        /**
         * Initializes Firebase and handles user authentication.
         */
        const initializeFirebase = async () => {
            try {
                if (Object.keys(firebaseConfig).length > 0) {
                    const { initializeApp } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js");
                    const { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");
                    // const { getFirestore } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"); // Uncomment if Firestore is used

                    firebaseApp = initializeApp(firebaseConfig);
                    firebaseAuth = getAuth(firebaseApp);
                    // firestoreDb = getFirestore(firebaseApp); // Uncomment if Firestore is used

                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(firebaseAuth, __initial_auth_token);
                    } else {
                        await signInAnonymously(firebaseAuth);
                    }

                    onAuthStateChanged(firebaseAuth, (user) => {
                        if (user) {
                            userId = user.uid;
                        } else {
                            userId = crypto.randomUUID(); // Use a random UUID if not authenticated
                        }
                        authReady = true;
                        updateUserIdDisplay();
                    });
                } else {
                    // If Firebase config is not available, proceed without authentication
                    userId = crypto.randomUUID();
                    authReady = true;
                    updateUserIdDisplay();
                }
            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
                userId = crypto.randomUUID();
                authReady = true;
                updateUserIdDisplay();
            }
        };

        /**
         * Updates the user ID display in the header.
         */
        const updateUserIdDisplay = () => {
            const userIdDisplay = document.getElementById('user-id-display');
            const currentUserIdSpan = document.getElementById('current-user-id');
            if (authReady && userId) {
                currentUserIdSpan.textContent = userId;
                userIdDisplay.classList.remove('hidden');
            } else {
                userIdDisplay.classList.add('hidden');
            }
        };

        let currentPage = 'home';
        const contentArea = document.getElementById('content-area');
        const mainNav = document.getElementById('main-nav');

        /**
         * Renders the content for the specified page and attaches event listeners.
         * @param {string} pageName - The name of the page to render.
         */
        const renderPage = (pageName) => {
            currentPage = pageName;
            let pageContent = '';
            switch (pageName) {
                case 'home':
                    pageContent = HomePage();
                    break;
                case 'understanding-sa':
                    pageContent = UnderstandingSA();
                    break;
                case 'resources':
                    pageContent = ResourcesPage();
                    break;
                case 'prevention':
                    pageContent = PreventionPage();
                    break;
                case 'support-survivors':
                    pageContent = SupportSurvivorsPage();
                    break;
                case 'report':
                    pageContent = ReportPage();
                    break;
                case 'raise-penalties':
                    pageContent = RaisePenaltiesPage();
                    break;
                default:
                    pageContent = HomePage();
            }
            contentArea.innerHTML = pageContent;
            updateNavItems(); // Update active state of nav buttons

            // Attach specific event listeners for LLM features after content is rendered
            if (pageName === 'understanding-sa') {
                const explainTermBtn = document.getElementById('explain-term-btn');
                if (explainTermBtn) {
                    explainTermBtn.addEventListener('click', handleExplainTerm);
                }
            } else if (pageName === 'raise-penalties') {
                const draftEmailBtn = document.getElementById('draft-email-btn');
                if (draftEmailBtn) {
                    draftEmailBtn.addEventListener('click', handleDraftAdvocacyEmail);
                }
            }
        };

        /**
         * Handles the "Explain Term" functionality using Gemini API.
         */
        const handleExplainTerm = async () => {
            const termInput = document.getElementById('term-input');
            const explainOutput = document.getElementById('explain-output');
            const explainLoading = document.getElementById('explain-loading');

            const term = termInput.value.trim();
            if (!term) {
                explainOutput.innerHTML = '<p class="text-red-500">Please enter a term to explain.</p>';
                return;
            }

            explainOutput.innerHTML = '';
            explainLoading.classList.remove('hidden');

            try {
                const prompt = `Provide a concise and informative explanation of the following term related to sexual assault awareness: "${term}". Keep it to 2-3 sentences.`;
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    explainOutput.innerHTML = `<p class="text-gray-700 mt-2 p-3 bg-gray-50 rounded-lg border border-gray-200">${text}</p>`;
                } else {
                    explainOutput.innerHTML = '<p class="text-red-500">Could not get an explanation. Please try again.</p>';
                    console.error("Gemini API response structure unexpected:", result);
                }
            } catch (error) {
                explainOutput.innerHTML = '<p class="text-red-500">Error fetching explanation. Please check your network.</p>';
                console.error("Error calling Gemini API for explanation:", error);
            } finally {
                explainLoading.classList.add('hidden');
            }
        };

        /**
         * Handles the "Draft Advocacy Email" functionality using Gemini API.
         */
        const handleDraftAdvocacyEmail = async () => {
            const pointsInput = document.getElementById('advocacy-points-input');
            const emailOutput = document.getElementById('email-output');
            const emailLoading = document.getElementById('email-loading');

            const points = pointsInput.value.trim();
            if (!points) {
                emailOutput.innerHTML = '<p class="text-red-500">Please enter some key points for the email.</p>';
                return;
            }

            emailOutput.innerHTML = '';
            emailLoading.classList.remove('hidden');

            try {
                const prompt = `Draft a concise and impactful advocacy email (for a public official) regarding increasing prison and jail time penalties for all types of sexual assault. Incorporate the following key points: "${points}". Keep the tone respectful but firm.`;
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    emailOutput.innerHTML = `<textarea rows="10" readonly class="w-full p-3 bg-gray-50 rounded-lg border border-gray-200 text-gray-700 mt-2">${text}</textarea>`;
                } else {
                    emailOutput.innerHTML = '<p class="text-red-500">Could not draft the email. Please try again.</p>';
                    console.error("Gemini API response structure unexpected:", result);
                }
            } catch (error) {
                emailOutput.innerHTML = '<p class="text-red-500">Error drafting email. Please check your network.</p>';
                console.error("Error calling Gemini API for email draft:", error);
            } finally {
                emailLoading.classList.add('hidden');
            }
        };


        /**
         * Creates an SVG icon.
         * @param {string} pathD - The 'd' attribute for the SVG path.
         * @returns {string} The HTML string for the SVG icon.
         */
        const createSvgIcon = (pathD) => `
            <svg class="w-8 h-8 flex-shrink-0 mt-1" fill="currentColor" viewBox="0 0 24 24">
                <path d="${pathD}" />
            </svg>
        `;

        /**
         * Generates the HTML for an InfoCard component.
         * @param {object} props - The props for the InfoCard.
         * @param {string} props.title
         * @param {string} props.description
         * @param {string} props.icon - SVG path 'd' attribute.
         * @param {string} props.bgColor - Tailwind background color class.
         * @param {string} props.textColor - Tailwind text color class.
         * @returns {string} HTML string for the InfoCard.
         */
        const InfoCard = ({ title, description, icon, bgColor, textColor }) => `
            <div class="${bgColor} ${textColor} p-6 rounded-lg shadow-md flex items-start space-x-4 transition-all">
                ${createSvgIcon(icon)}
                <div>
                    <h3 class="text-xl font-semibold mb-2">${title}</h3>
                    <p class="text-base">${description}</p>
                </div>
            </div>
        `;

        /**
         * Generates the HTML for a MisconceptionCard component.
         * @param {object} props - The props for the MisconceptionCard.
         * @param {string} props.myth
         * @param {string} props.fact
         * @returns {string} HTML string for the MisconceptionCard.
         */
        const MisconceptionCard = ({ myth, fact }) => `
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200 transition-all">
                <p class="font-semibold text-red-700 mb-2">${myth}</p>
                <p class="text-gray-700">${fact}</p>
            </div>
        `;

        /**
         * Generates the HTML for a ResourceCard component.
         * @param {object} props - The props for the ResourceCard.
         * @param {string} props.title
         * @param {string} props.description
         * @param {string} [props.phone]
         * @param {string} [props.text]
         * @param {string} [props.website]
         * @param {string} props.type
         * @returns {string} HTML string for the ResourceCard.
         */
        const ResourceCard = ({ title, description, phone, text, website, type }) => `
            <div class="bg-gray-50 p-6 rounded-lg shadow-md border border-gray-200 transition-all">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">${title}</h3>
                <p class="text-sm text-gray-600 mb-3 font-medium">${type}</p>
                <p class="text-gray-700 mb-4">${description}</p>
                ${phone ? `<p class="mb-2">
                    <span class="font-semibold text-gray-800">Phone:</span> <a href="tel:${phone.replace(/-/g, '')}" class="text-blue-600 hover:underline">${phone}</a>
                </p>` : ''}
                ${text ? `<p class="mb-2">
                    <span class="font-semibold text-gray-800">Text:</span> ${text}
                </p>` : ''}
                ${website ? `<p>
                    <span class="font-semibold text-gray-800">Website:</span> <a href="${website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${website.replace(/https?:\/\//, '')}</a>
                </p>` : ''}
            </div>
        `;

        /**
         * Generates the HTML for a ReportingOptionCard component.
         * @param {object} props - The props for the ReportingOptionCard.
         * @param {string} props.title
         * @param {string} props.description
         * @param {string} props.considerations
         * @returns {string} HTML string for the ReportingOptionCard.
         */
        const ReportingOptionCard = ({ title, description, considerations }) => `
            <div class="bg-gray-50 p-6 rounded-lg shadow-md border border-gray-200 transition-all">
                <h3 class="text-xl font-semibold text-red-700 mb-2">${title}</h3>
                <p class="text-gray-700 mb-3">${description}</p>
                <p class="text-gray-600 text-sm">
                    <span class="font-semibold">Considerations:</span> ${considerations}
                </p>
            </div>
        `;

        // Page content functions (return HTML strings)
        const HomePage = () => `
            <h2 class="text-4xl font-extrabold text-gray-800 mb-6 text-center">Welcome to Sexual Assault Awareness</h2>
            <p class="text-lg leading-relaxed mb-4 text-gray-700">
                This application is dedicated to raising awareness about sexual assault, providing vital information, and connecting individuals with resources for support, prevention, and reporting.
            </p>
            <p class="text-lg leading-relaxed mb-4 text-gray-700">
                Sexual assault is a serious issue that affects countless individuals. Our goal is to foster a community of understanding, empathy, and safety.
            </p>
            <div class="grid md:grid-cols-2 gap-6 mt-8">
                ${InfoCard({
                    title: "Understanding Consent",
                    description: "Learn what consent truly means and why it's crucial in every interaction.",
                    icon: "M13 10V3L4 14h7v7l9-11h-7z",
                    bgColor: "bg-gray-100",
                    textColor: "text-gray-700"
                })}
                ${InfoCard({
                    title: "Finding Support",
                    description: "Discover national and local resources available for survivors and their loved ones.",
                    icon: "M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 4v-4z",
                    bgColor: "bg-gray-100",
                    textColor: "text-gray-700"
                })}
            </div>
            <p class="text-md leading-relaxed mt-6 text-center text-gray-600">
                Please explore the different sections of the app to gain knowledge and find the help you need.
            </p>
        `;

        const UnderstandingSA = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Understanding Sexual Assault</h2>
            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">What is Sexual Assault?</h3>
                <p class="leading-relaxed mb-3 text-gray-700">
                    Sexual assault is any type of sexual contact or behavior that occurs without the explicit consent of the recipient. It can include a wide range of behaviors, from unwanted touching to rape. It's important to remember that sexual assault is never the victim's fault.
                </p>
                <p class="leading-relaxed text-gray-700">
                    Key elements often involve power, control, and a violation of trust or bodily autonomy.
                </p>
            </section>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">The Importance of Consent</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Consent must be affirmative:</strong> A clear, enthusiastic "yes." Absence of "no" is not consent. Silence is not consent.</li>
                    <li><strong>Consent must be ongoing:</strong> Consent can be withdrawn at any time, even if it was initially given.</li>
                    <li><strong>Consent must be voluntary:</b> It cannot be given under duress, manipulation, or threat.</li>
                    <li><strong>Consent cannot be given if incapacitated:</strong> A person cannot consent if they are unconscious, asleep, or impaired by drugs or alcohol to the extent they cannot understand the nature of the sexual act.</li>
                    <li><strong>Consent must be specific:</strong> Consent to one type of sexual activity does not imply consent to another.</li>
                </ul>
                <p class="leading-relaxed mt-4 text-gray-700">
                    Understanding and respecting consent is fundamental to preventing sexual assault and fostering healthy relationships.
                </p>
            </section>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Common Misconceptions</h3>
                <div class="space-y-4 mb-6">
                    ${MisconceptionCard({
                        myth: "Myth: Sexual assault only happens to women.",
                        fact: "Fact: Sexual assault can happen to anyone, regardless of gender, age, sexual orientation, or background."
                    })}
                    ${MisconceptionCard({
                        myth: "Myth: What someone wears or how they act can cause sexual assault.",
                        fact: "Fact: No one's clothing or behavior justifies sexual assault. The only cause of sexual assault is the perpetrator's actions."
                    })}
                    ${MisconceptionCard({
                        myth: "Myth: If someone doesn't fight back, it wasn't assault.",
                        fact: "Fact: Freezing or 'tonic immobility' is a common trauma response. A lack of resistance does not imply consent."
                    })}
                </div>
            </section>

            <section>
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">✨ Explain a Term</h3>
                <div class="flex flex-col sm:flex-row gap-3 mb-4">
                    <input type="text" id="term-input" placeholder="e.g., 'Bystander Intervention'" class="flex-grow p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all">
                    <button id="explain-term-btn" class="px-5 py-2 rounded-full bg-gray-700 text-white font-medium hover:bg-gray-600 transition-all shadow-md">
                        ✨ Explain Term
                    </button>
                </div>
                <div id="explain-loading" class="hidden text-center text-gray-600">
                    <div class="loader mx-auto my-4 w-6 h-6 border-2"></div>
                    Loading explanation...
                </div>
                <div id="explain-output" class="text-gray-700 mt-2"></div>
            </section>
        `;

        const ResourcesPage = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Resources & Support</h2>
            <p class="leading-relaxed mb-6 text-gray-700">
                If you or someone you know needs support, help is available. Here are some national and international resources. Please check for local resources specific to your area.
            </p>

            <div class="grid md:grid-cols-2 gap-6">
                ${ResourceCard({
                    title: "RAINN (Rape, Abuse & Incest National Network)",
                    description: "The largest anti-sexual violence organization in the U.S. Operates the National Sexual Assault Hotline.",
                    phone: "1-800-656-HOPE",
                    website: "https://www.rainn.org/",
                    type: "National Hotline"
                })}
                ${ResourceCard({
                    title: "National Sexual Violence Resource Center (NSVRC)",
                    description: "Provides leadership in preventing and responding to sexual violence through collaboration, sharing, and advocating for change.",
                    website: "https://www.nsvrc.org/",
                    type: "Information & Advocacy"
                })}
                ${ResourceCard({
                    title: "Love Is Respect",
                    description: "Focuses on healthy relationships, relationship abuse, and digital abuse for teens and young adults.",
                    phone: "1-866-331-9474",
                    text: "Text LOVEIS to 22522",
                    website: "https://www.loveisrespect.org/",
                    type: "Youth Support"
                })}
                ${ResourceCard({
                    title: "Crisis Text Line",
                    description: "Free, 24/7 support for those in crisis. Text 'HOME' to reach a crisis counselor.",
                    text: "Text HOME to 741741",
                    website: "https://www.crisistextline.org/",
                    type: "Crisis Support"
                })}
            </div>

            <p class="leading-relaxed mt-8 text-gray-700">
                Always remember, you are not alone, and help is available. Reaching out is a brave first step.
            </p>
        `;

        const PreventionPage = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Prevention Strategies</h2>
            <p class="leading-relaxed mb-6 text-gray-700">
                Preventing sexual assault requires a multi-faceted approach, involving individual actions, community efforts, and systemic changes. Everyone has a role to play.
            </p>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Individual Actions</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Practice enthusiastic consent:</strong> Always seek clear, voluntary, and enthusiastic consent for any sexual activity.</li>
                    <li><strong>Be an active bystander:</strong> If you see a potentially unsafe situation, intervene if it's safe to do so, or get help.</li>
                    <li><strong>Communicate openly:</strong> Foster open conversations about boundaries and respect in all relationships.</li>
                    <li><strong>Educate yourself and others:</strong> Stay informed about sexual assault and share accurate information.</li>
                </ul>
            </section>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Community & Systemic Approaches</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Support prevention programs:</strong> Advocate for and participate in evidence-based sexual violence prevention education.</li>
                    <li><strong>Challenge harmful norms:</strong> Speak out against rape culture, victim-blaming, and gender inequality.</li>
                    <li><strong>Promote healthy masculinity:</strong> Encourage positive expressions of masculinity that reject dominance and violence.</li>
                    <li><strong>Advocate for policy change:</strong> Support laws and policies that protect survivors and hold perpetrators accountable.</li>
                </ul>
            </section>

            <p class="leading-relaxed mt-6 text-center text-gray-600">
                Prevention is a shared responsibility. By working together, we can create safer communities for everyone.
            </p>
        `;

        const SupportSurvivorsPage = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Support for Survivors</h2>
            <p class="leading-relaxed mb-6 text-gray-700">
                If you or someone you care about has experienced sexual assault, remember that healing is a process, and support is available.
            </p>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Immediate Steps (If Recent Assault)</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Prioritize safety:</strong> Get to a safe place away from the perpetrator.</li>
                    <li><strong>Seek medical attention:</strong> Even if there are no visible injuries, a medical exam can address potential health concerns (e.g., STIs, pregnancy) and collect forensic evidence.</li>
                    <li><strong>Contact a hotline:</strong> Organizations like RAINN can provide immediate support, guidance, and help you understand your options.</li>
                    <li><strong>Confide in a trusted person:</strong> Share with someone you trust, who can offer emotional support.</li>
                </ul>
                <p class="leading-relaxed mt-4 text-sm text-gray-600">
                    *Preserving evidence (e.g., not showering, changing clothes) is important if you are considering reporting, but your safety and well-being come first.*
                </p>
            </section>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Long-Term Healing & Support</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Therapy/Counseling:</strong> Trauma-informed therapy can help process the experience and develop coping mechanisms.</li>
                    <li><strong>Support Groups:</strong> Connecting with other survivors can reduce feelings of isolation and provide a sense of community.</li>
                    <li><strong>Self-Care:</strong> Engage in activities that promote your mental and physical well-being (e.g., exercise, mindfulness, creative expression).</li>
                    <li><strong>Legal Aid:</strong> If considering legal action, seek advice from an attorney specializing in sexual assault cases.</li>
                </ul>
            </section>

            <p class="leading-relaxed mt-6 text-center text-gray-600">
                Every survivor's journey is unique. Be patient and compassionate with yourself, and lean on your support system.
            </p>
        `;

        const ReportPage = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Reporting Sexual Assault</h2>
            <p class="leading-relaxed mb-6 text-gray-700">
                Deciding whether or not to report a sexual assault is a deeply personal choice. There is no right or wrong decision, and your safety and well-being are paramount.
            </p>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Options for Reporting</h3>
                <div class="space-y-4">
                    ${ReportingOptionCard({
                        title: "Law Enforcement (Police)",
                        description: "Reporting to the police can initiate a criminal investigation. This may lead to an arrest and prosecution of the perpetrator. You can report directly to your local police department.",
                        considerations: "This path can be lengthy and emotionally challenging. You have the right to an advocate present during interviews."
                    })}
                    ${ReportingOptionCard({
                        title: "Campus or School Authorities",
                        description: "If the assault occurred at a school or university, you can report to their Title IX office or equivalent. They have a responsibility to address sexual misconduct on campus.",
                        considerations: "Campus procedures vary. They often focus on campus safety and disciplinary actions against students/staff."
                    })}
                    ${ReportingOptionCard({
                        title: "Confidential Reporting",
                        description: "Many victim advocacy organizations and sexual assault crisis centers offer confidential reporting, meaning your information is not shared with law enforcement without your explicit consent.",
                        considerations: "This provides support without immediately entering the criminal justice system, allowing you to explore options at your own pace."
                    })}
                </div>
            </section>

            <section>
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Important Considerations</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Seek support first:</strong> Before deciding, consider reaching out to a sexual assault hotline or local advocacy center. They can explain all your options and provide support throughout the process.</li>
                    <li><strong>Evidence preservation:</strong> If considering reporting, try to preserve any evidence (e.g., don't shower, change clothes, or clean the scene). A SANE (Sexual Assault Nurse Examiner) exam can collect forensic evidence.</li>
                    <li><strong>Your rights:</strong> You have rights as a survivor, including the right to privacy, safety, and to be treated with dignity and respect throughout any reporting process.</li>
                    <li><strong>It's your choice:</strong> The decision to report, when to report, and how to report is entirely up to you.</li>
                </ul>
            </section>

            <p class="leading-relaxed mt-6 text-center text-gray-600">
                Reporting can be a complex decision. Please utilize available resources to make the choice that is best for you.
            </p>
        `;

        // New page content function for Raise Penalties
        const RaisePenaltiesPage = () => `
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Advocating for Stricter Penalties</h2>
            <p class="leading-relaxed mb-6 text-gray-700">
                Increasing the severity of prison and jail time for all types of sexual assault offenses is a critical step in deterring perpetrators, ensuring justice for survivors, and reinforcing society's condemnation of these crimes.
            </p>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">Why Stricter Penalties are Important</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Deterrence:</strong> Harsher penalties can serve as a stronger deterrent, making potential offenders think twice before committing such crimes.</li>
                    <li><strong>Justice for Survivors:</strong> More severe sentences can provide survivors with a greater sense of justice and accountability for the harm they have endured.</li>
                    <li><strong>Public Safety:</strong> Keeping dangerous offenders incarcerated for longer periods reduces their ability to re-offend and protects the community.</li>
                    <li><strong>Societal Message:</strong> Stricter sentencing sends a clear message that sexual assault is a grave crime that will not be tolerated, reflecting societal values.</li>
                </ul>
            </section>

            <section class="mb-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">How You Can Advocate</h3>
                <ul class="list-disc pl-5 leading-relaxed space-y-2 text-gray-700">
                    <li><strong>Contact Legislators:</strong> Reach out to your local, state, and national representatives to express your support for legislation that increases penalties for sexual assault.</li>
                    <li><strong>Support Advocacy Organizations:</strong> Donate to or volunteer with organizations that lobby for stronger sexual assault laws and support survivors.</li>
                    <li><strong>Raise Awareness:</strong> Share information about the current state of sexual assault laws and the need for reform within your community and on social media.</li>
                    <li><strong>Participate in Campaigns:</strong> Join or initiate petitions, rallies, and public awareness campaigns aimed at legislative change.</li>
                    <li><strong>Educate Others:</strong> Inform friends, family, and colleagues about the importance of stricter penalties and how they can get involved.</li>
                </ul>
            </section>

            <section>
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">✨ Draft Advocacy Email</h3>
                <div class="flex flex-col gap-3 mb-4">
                    <textarea id="advocacy-points-input" rows="4" placeholder="Enter key points or recipient info (e.g., 'my senator', 'focus on child protection')" class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-gray-500 focus:border-transparent transition-all"></textarea>
                    <button id="draft-email-btn" class="px-5 py-2 rounded-full bg-gray-700 text-white font-medium hover:bg-gray-600 transition-all shadow-md">
                        ✨ Draft Advocacy Email
                    </button>
                </div>
                <div id="email-loading" class="hidden text-center text-gray-600">
                    <div class="loader mx-auto my-4 w-6 h-6 border-2"></div>
                    Drafting email...
                </div>
                <div id="email-output" class="text-gray-700 mt-2"></div>
            </section>
        `;


        /**
         * Generates and appends navigation buttons to the main nav.
         */
        const createNavItems = () => {
            const navItems = [
                { label: "Home", page: "home" },
                { label: "Understanding SA", page: "understanding-sa" },
                { label: "Resources", page: "resources" },
                { label: "Prevention", page: "prevention" },
                { label: "Support Survivors", page: "support-survivors" },
                { label: "Report", page: "report" },
                { label: "Raise Penalties", page: "raise-penalties" } // New nav item
            ];

            mainNav.innerHTML = navItems.map(item => `
                <li>
                    <button
                        data-page="${item.page}"
                        class="px-5 py-2 rounded-full text-base font-medium transition-all duration-300 ease-in-out
                        ${item.page === currentPage ? 'bg-gray-200 text-gray-800 shadow-md' : 'text-gray-200 hover:bg-gray-700 hover:text-white'}">
                        ${item.label}
                    </button>
                </li>
            `).join('');

            // Add event listeners to the new buttons
            mainNav.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', () => {
                    renderPage(button.dataset.page);
                });
            });
        };

        /**
         * Updates the active state of navigation buttons.
         */
        const updateNavItems = () => {
            mainNav.querySelectorAll('button').forEach(button => {
                if (button.dataset.page === currentPage) {
                    button.classList.add('bg-gray-200', 'text-gray-800', 'shadow-md');
                    button.classList.remove('text-gray-200', 'hover:bg-gray-700', 'hover:text-white');
                } else {
                    button.classList.remove('bg-gray-200', 'text-gray-800', 'shadow-md');
                    button.classList.add('text-gray-200', 'hover:bg-gray-700', 'hover:text-white');
                }
            });
        };

        // Initialize on window load
        window.onload = () => {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            initializeFirebase(); // Initialize Firebase first
            createNavItems(); // Create nav items after Firebase init (for user ID display)
            renderPage('home'); // Render the home page initially
        };
    </script>
</body>
</html>
